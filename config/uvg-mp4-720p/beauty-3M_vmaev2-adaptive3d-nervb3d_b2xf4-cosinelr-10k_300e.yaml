name: Beauty-3M_vmaev2-adaptive3d-nervb3d_b2xf4-cosinelr-10k_300e

dataloader:
  type: build_dataloader

  args:
    name: "uvghd30"
    data_path: "data/beauty.mp4"                       # EXPERIMENTS
    crop_size: [720, 1280]                             
    num_workers: 0  

    batch_size: 2                                      # MEMORY
    frame_interval: 4                                  # MEMORY

metrics:
  type: psnr_batch

  args:
    batch_size: 2                                   # MEMORY  
    frame_interval: 4                               # MEMORY

arch:
  type: HNeRVMae

  args:
    img_size: [720, 1280] 
    frame_interval: 4                   # MEMORY      
    
    embed_dim: 8 
    embed_size: [9, 16]
    decode_dim: 314

    lower_kernel: 1
    upper_kernel: 5
    scales: [5, 4, 2, 2]
    reduce: 3
    lower_width: 6

    ckpt_path: "../ckpt/vit_s_k710_dl_from_giant.pth"

loss:
  type: loss_fn

  args:
    loss_type: "L2"
    batch_average: False

optimizer:
  type: Adam

  args: 
    lr: 0.001 
    betas: [0.9, 0.99]

lr_scheduler:
  type: CosineAnnealingLR

  args:
    T_max: 0.000001     # 1e-6
    eta_min: 0.0

trainer:
  resume: False 
  
  epochs: 300
  valid_period: 10

  save_dir: saved/
  save_period: 1
  verbosity: 1

  visual_tool: wandb
  mode: "offline"
  project: nerv3d
  api_key_file: "./config/api/tuanlda78202"
  entity: tuanlda78202
  name: "beauty-3M_vmaev2-adaptive3d-nervb3d_b2xf4-cosinelr-10k_300e"              # EXPERIMENTS


eval: 
  eval_only: False
  eval_freq: 10 # evaluation frequency
  eval_fps: False # fwd multiple times to test the fps

  quant_model_bit: 8 # bit length for model quantization
  quant_embed_bit: 6 # bit length for embedding quantization
  quant_axis: 0     # quantization axis (-1 means per tensor)

  dump_images: False # dump the prediction images
  dump_videos: False # concat the prediction images into video

  encoder_file: ""  # specify the embedding file


log: 
  # logging, output directory
  debug: False # defbug status, earlier for train/eval
  print-freq: 50 

  weight: None # pre-trained weights for ininitialization
  overwrite: False # overwrite the output dir if already exists

  outf: unify # folder to output images and model checkpoints
  suffix: "" # suffix str for outf


